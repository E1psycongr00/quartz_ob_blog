---
tags:
  - 완성
  - 클린코드
aliases: 
title: 임시 변수 지양하기
date: 2024-02-05
---
작성 날짜: 2024-02-05
작성 시간: 21:55


----

## 문제 & 원인

### 임시 변수를 통해 복잡해진 함수
#### 문제의 코드 해석하기
```js
// 사용자 정의 출력 형태로 변경
util.inspect = function (obj, options) {
    let result = "";
    if (Array.isArray(obj) && Array.isArray(obj[0])) {
        // 2차원 배열의 경우, 각 행을 [ ]로 묶어서 출력
        result += "이것은 2차원 배열\n";
        return (
            result +
            ("[" +
                obj.map(row => "[" + row.join(", ") + "]").join(",\n ") +
                "]")
        );
    }
    // 기존 inspect 메서드로 출력
    result += "이것은 일반 객체\n";
    return result + originalInspect(obj, options);
};
```

위와 같은 코드를 살펴보자. util.inspect 코드를 내가 의도한 코드처럼 쓰려고 한다. 사실 위 코드는 위험한 코드인데, 클린 코드 입장에서만 살펴보자. 

우선 위 코드를 해석하면 다음과 같다. inspect는 console.log()에서  객체를 나타내는데 쓰이는 함수이다. 위에서는 함수가 2차원일 때 줄바꿈해서 행렬 보 듯 출력하고, 나머지는 이전에 쓰이던 함수 그대로 쓰려고 한다. 

#### 문제의 코드가 가지는 위험성
- 코드에 여러 로직이 섞여있다. 
	- 2차원 배열 출력 로직이 들어 있다.
	- 나머지는 오리지널 출력 로직이 있다.
	- if문을 통해 어떤 로직들을 호출할지 관리하고 있다.
- 코드에 문제가 발생하면 해당 함수에서 해당 문제를 찾아야 하기 떄문에 디버깅이 어렵다.
- result라는 변수가 마치 함수 내에서 전역변수처럼 쓰이고 있다.
- 일부분에 로직이 변경되더라도  요구 사항이 생기면 매번 해당 함수를 디버깅하고 수정해야 한다.


## 해결 방안

>[!summary] 임시 변수 문제 해결법
>- 함수를 분리한다.
>- 고차함수를 이용한다.(map, filter 등등)

위 코드 문제는 함수가 너무 많은 책임 지는 것이다. 그래서 함수를 분리할 필요성이 있다.
1. 우리가 원하는 조건에 따른 호출 함수
2. 내부 로직을 함수로 분리
3. 내부의 전역 변수 제거

예제 코드는 여러가지 문제가 있지만, 우리는 임시 변수의 사용의 문제점에 대해서 포커싱을 맞춰서 이 문제를 해결하려고 한다.

우선 왜 전역변수처럼 사용되었는지 분석해보자.

사용자 정의 출력 형태로 변경하는 함수를 정의하는데 result라는 임시 변수를 정의하고 2가지 경우에 따라 다른 출력 형태를 보여준다. 그리고 임시 변수가 필요한 이유는 result라는 문자열 객체에 일반 객체인지 2차원 배열 객체인지 설명해주기 위해 정보가 계속 추가되기 때문에 사용된다. 이 문제를 해결해보자.

```js
// 사용자 정의 출력 형태로 변경(배열 소개 + 객체 출력)
function (obj, options) {
    // 2차원 배열인 경우 2차원 형태로 출력
    // 기본 객체인 경우, 기본 객체 형태로 출력
};
```

```js
function (obj, options) {
	if (Array.isArray(obj) && Array.isArray(obj[0])) {
		return "이것은 2차원 배열\n" + print2DArrayObj(obj, options)
	}
	return "이것은 일반 객체\n" + originalInspect(obj, options)
}
```

## 질문 & 확장

임시 변수를 이용해 전역 변수처럼 사용하는 실수는 생각보다 사람들이 많이 하는 실수이다. 알고리즘 사이트같은 경우를 보면 이런 코드가 흔하다. 전역 변수가 나쁘다는 것은 아니지만, 하나의 변수가 여러 로직에서 쓰이면 의존성이 높아지고, 코드의 유지 보수가 어려워진다. 그런 이유 때문에 중복을 줄이기 위해 전역변수를 쓰는 방법은 좋은 방법은 아닌 것 같다.
## 출처(링크)


## 연결 노트


