---
tags:
  - 완성
  - OS
  - Process
  - Thread
aliases: []
---
작성 날짜: 2024-01-05
작성 시간: 20:02


----
## 내용(Content)

### 멀티 쓰레드를 사용하는 이유

멀티 쓰레드를 사용하는 이유는 뭘까? 보통 쓰레드를 많이 사용한다는 것은 2가지 의미로 해석할 수 있다.

1. 물리적인 코어를 많이 활용하기 위함.
2. 여러 쓰레드를 switching하며 실행해서 동시에 실행하는 것처럼 보임.

이 2가지의 특징은 [[CPU의 작업 처리 방식 (병렬성과 동시성)|병렬성과 동시성]]을 참고하자.

위의 2가지를 토대로 몇 가지 관점을 제시할 수 있다.

1. 동시성 관점
2. context switching의 관점
3. CPU bound, I/O bound 관점

위 3가지 관점에서 왜 멀티 쓰레드가 성능을 높일 수 있는지에 대해서 고민해보자.

### 동시성 관점

동시성은 (Cocurrency)로 동시에 더 많은 작업들을 실행할 수 있다. 그래서 애플리케이션의 성능이 전체적으로 좋아질 것 같다는 생각이 든다. 

동시성에서 왜 이런 문제가 발생할 수 있는지 살펴보면, 임계 영역에 있다. 멀티 쓰레드는 일부 메모리를 공유할 수 있기 때문에 문제가 발생할 수 있다.

>[!info] 임계 영역(Critical Section)
>멀티 쓰레드 프로그래밍에서 임계 영역은 공유 자원을 접근하는 코드 영역을 말한다. 대표적으로 전역 변수나 heap 메모리 영역을 들 수 있다..

동기화 기법에 따라 `뮤텍스`나 `세마포어` 같은 잠금 기법이 있는데 공유 자원을 안정적으로 쓰기 위해서는 하나의 쓰레드만 공유 자원에 접근할 수 있도록 제한해야 하며 데이터에 대한 일관성을 유지한다. 그러나 이런 동기화 기법은 스레드 간의 경쟁 대기 상황을 발생 시킬 수 있기 때문에 오히려 성능에 부정적인 영향을 미칠 수 있다.

### context switching 관점

간단하게 Context Switching은 코어에서 실행되는 쓰레드가 다른 쓰레드로 바뀌는 작업을  Context Switching이라고 한다. 이런 스위칭 작업 또한 CPU 코어에서 실행되는 작업이다. 스위칭될 때 커널에서부터 시스템콜 등등 쓰레드가 전환되면서 여러가지 작업들이 실행되는데 하는 작업 외의 오버헤드들이 쓰레드가 많아지면 경합 횟수가 늘어나므로 성능 면에서 한계에 부딪칠 수 있다.

### CPU bound, I/O bound 관점

[[IO Bound와 CPU Bound]] 정리한 내용에 따르면 CPU bound 애플리케이션은 CPU를 많이 사용하기 때문에 코어 갯수 + 1 쓰레드면 충분하다. 그 이상의 쓰레드는 오히려 오버헤드를 발생할 가능성이 크다. 그러나 I/O bound의 경우에는 I/O 작업이 많기 때문에 CPU가 쉬고 있는 시간이 많고 이럴 때는 동시에 빠르게 처리하기 위해서 쓰레드가 코어 갯수의 2배, 3배가 되도 괜찮다. 그러면 OverHead 보다 CPU가 비어 있는 시간동안 코어를 효율적으로 쓸 수 있기 때문에 효과적이다. 

Context Switching의 연장선이긴 하지만 bound에 따라 CPU 사용량이 달라지기 때문에 CPU가 비어 있다면 오히려 오버헤드가 발생하더라도 CPU가 쉬는 거보단 훨씬 좋다.
## 질문 & 확장

(없음)

## 출처(링크)
- https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-Is-more-threads-always-better#cpu_%EB%B0%94%EC%9A%B4%EB%93%9C_%EC%96%B4%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98
- https://www.youtube.com/watch?v=jSaBkvtHhrM
- https://easy-code-yo.tistory.com/45
## 연결 노트

- [[CPU의 작업 처리 방식 (병렬성과 동시성)]]









